<!--model List<EntityLayer.Concrete.Dtos.StokDto>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />

<style>
    .custom-table th, .custom-table td {
        vertical-align: middle;
    }

    .btn-edit {
        background-color: #4e73df;
        color: white;
    }

    .btn-delete {
        background-color: #e74a3b;
        color: white;
    }

    .table-container {
        background-color: #f8f9fc;
        padding: 30px;
        border-radius: 16px;
        box-shadow: 0 4px 16px rgba(0,0,0,0.1);
    }
</style>

<div class="container mt-5">
    <div class="table-container">
        <h2 class="text-center mb-4">📦 Stok Listesi</h2>
        <div class="table-responsive">
            <table class="table custom-table table-striped table-hover align-middle text-center">
                <thead class="table-primary">
                    <tr>
                        <th>#</th>
                        <th>Depo Adı</th>
                        <th>Stok Miktarı</th>
                        <th style="width: 500px">İşlemler</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>
</div>-->
<!-- Bootstrap Icons CDN -->
<!--<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

<script>
    function changeStock(id) {
        $.ajax({
            url: "/Urunler/ChangeStockPartial",
            type: "GET",
            data: { id: id },
            success: function (response) {
                $("#modalContent").html(response);
            },
            error: function (xhr, status, error) {
                console.error("Hata Detayı:", xhr.responseText);
                alert("Sunucu hatası oluştu");
            }
        })
    }
</script>-->

@model int

<div class="grid-container card shadow-sm p-3 mb-4 bg-white rounded">
    <div class="table-responsive">
        <table id="gridd" class="table table-bordered"></table>
        <div id="pagerr"></div>
    </div>
</div>

<script>
    jQuery("#gridd").jqGrid({
        postData: { id: '@Model' },
        url: '/Stok/GetByUrunId',
        datatype: "json",
        mtype: "GET",
        colNames: ['Depo', 'Stok Miktarı', 'Detay'],
        colModel: [
            { name: 'depoName', index: 'depoName', width: 200, align: 'center' },
            { name: 'stokMiktar', index: 'stokMiktar', width: 150, align: 'center' },
            { name: 'detay', width: 50, align: 'left', formatter: ButtonDetailsFormatter, sortable: false }
        ],
        rowNum: 10,
        rowList: [5, 10, 20],
        pager: '#pagerr',
        sortname: 'depoName',
        viewrecords: true,
        sortorder: "asc",
        autoencode: true,
        height: 'auto',
        autowidth: true,
        shrinkToFit: true,
        gridComplete: function () {
            $(".detaillbutton").click(function () {
                var id = $(this).data("id");
                changeStock(id);
            });
        },
        loadError: function (xhr, status, error) {
            alert("Veri yüklenirken hata oluştu: " + error);
        }
    });

    function ButtonDetailsFormatter(cellvalue, options, rowObject) {
        return `
            <button class="detaillbutton btn btn-success btn-sm" style="padding:2px 6px; font-size:12px;" data-id="${rowObject.id}">Detay</button>

        `;
    }

    function changeStock(id) {
        $.ajax({
            url: "/Urunler/ChangeStockPartial",
            type: "GET",
            data: { id: id },
            success: function (response) {
                $("#modalContent").html(response);
            },
            error: function (xhr, status, error) {
                console.error("Hata Detayı:", xhr.responseText);
                alert("Sunucu hatası oluştu");
            }
        })
    }
</script>
