!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","./grid.base","./jquery.fmatter","./grid.utils"],e):e(jQuery)}(function(fe){"use strict";fe.jgrid=fe.jgrid||{},fe.extend(fe.jgrid,{formatCell:function(e,t,r,l,o,a){return void 0!==l.formatter?(t={rowId:"",colModel:l,gid:o.p.id,pos:t,styleUI:"",isExported:!0,exporttype:a},fe.jgrid.isFunction(l.formatter)?l.formatter.call(o,e,t,r):fe.fmatter?fe.fn.fmatter.call(o,l.formatter,e,t,r):e):e},formatCellCsv:function(e,t){e=null==e?"":String(e);try{e=fe.jgrid.stripHtml(e.replace(t._regexsep,t.separatorReplace).replace(/\r\n/g,t.replaceNewLine).replace(/\n/g,t.replaceNewLine))}catch(t){e=""}return-1!==(e=t.escquote?e.replace(t._regexquot,t.escquote+t.quote):e).indexOf(t.separator)&&-1!==e.indexOf(t.qoute)?e:t.quote+e+t.quote},excelCellPos:function(e){for(var t="A".charCodeAt(0),r="Z".charCodeAt(0)-t+1,l="";0<=e;)l=String.fromCharCode(e%r+t)+l,e=Math.floor(e/r)-1;return l},makeNode:function(e,t,r){var l=e.createElement(t);return r&&(r.attr&&fe(l).attr(r.attr),r.children&&fe.each(r.children,function(e,t){l.appendChild(t)}),r.hasOwnProperty("text"))&&l.appendChild(e.createTextNode(r.text)),l},xmlToZip:function(o,e){var a,n,d,i,p,s=this,m=new XMLSerializer,f=-1===m.serializeToString(fe.parseXML(fe.jgrid.excelStrings["xl/worksheets/sheet1.xml"])).indexOf("xmlns:r"),c=[];fe.each(e,function(e,t){if(fe.isPlainObject(t))p=o.folder(e),s.xmlToZip(p,t);else{if(f){for(a=t.childNodes[0],n=a.attributes.length-1;0<=n;n--){var r=a.attributes[n].nodeName,l=a.attributes[n].nodeValue;-1!==r.indexOf(":")&&(c.push({name:r,value:l}),a.removeAttribute(r))}for(n=0,d=c.length;n<d;n++)(i=t.createAttribute(c[n].name.replace(":","_dt_b_namespace_token_"))).value=c[n].value,a.setAttributeNode(i)}p=m.serializeToString(t),p=(p=f?(p=-1===p.indexOf("<?xml")?'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+p:p).replace(/_dt_b_namespace_token_/g,":"):p).replace(/<row xmlns="" /g,"<row ").replace(/<cols xmlns="">/g,"<cols>").replace(/<mergeCells xmlns="" /g,"<mergeCells ").replace(/<numFmt xmlns="" /g,"<numFmt ").replace(/<xf xmlns="" /g,"<xf "),o.file(e,p)}})},excelStrings:{"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>',"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/></Relationships>',"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="xml" ContentType="application/xml" /><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" /><Default Extension="jpeg" ContentType="image/jpeg" /><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" /><Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" /><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" /></Types>',"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="24816"/><workbookPr showInkAnnotation="0" autoCompressPictures="0"/><bookViews><workbookView xWindow="0" yWindow="0" windowWidth="25600" windowHeight="19020" tabRatio="500"/></bookViews><sheets><sheet name="Sheet1" sheetId="1" r:id="rId1"/></sheets></workbook>',"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><sheetData/></worksheet>',"xl/styles.xml":'<?xml version="1.0" encoding="UTF-8"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><numFmts count="7"><numFmt numFmtId="164" formatCode="#,##0.00_- [$$-45C]"/><numFmt numFmtId="165" formatCode="&quot;£&quot;#,##0.00"/><numFmt numFmtId="166" formatCode="[$€-2] #,##0.00"/><numFmt numFmtId="167" formatCode="0.0%"/><numFmt numFmtId="168" formatCode="#,##0;(#,##0)"/><numFmt numFmtId="169" formatCode="#,##0.00;(#,##0.00)"/><numFmt numFmtId="170" formatCode="yyyy/mm/dd;@"/></numFmts><fonts count="5" x14ac:knownFonts="1"><font><sz val="11" /><name val="Calibri" /></font><font><sz val="11" /><name val="Calibri" /><color rgb="FFFFFFFF" /></font><font><sz val="11" /><name val="Calibri" /><b /></font><font><sz val="11" /><name val="Calibri" /><i /></font><font><sz val="11" /><name val="Calibri" /><u /></font></fonts><fills count="6"><fill><patternFill patternType="none" /></fill><fill/><fill><patternFill patternType="solid"><fgColor rgb="FFD9D9D9" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="FFD99795" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6efce" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6cfef" /><bgColor indexed="64" /></patternFill></fill></fills><borders count="2"><border><left /><right /><top /><bottom /><diagonal /></border><border diagonalUp="false" diagonalDown="false"><left style="thin"><color auto="1" /></left><right style="thin"><color auto="1" /></right><top style="thin"><color auto="1" /></top><bottom style="thin"><color auto="1" /></bottom><diagonal /></border></borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" /></cellStyleXfs><cellXfs count="69"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="left"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="center"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="right"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="fill"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment textRotation="90"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment wrapText="1"/></xf><xf numFmtId="9"   fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="164" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="165" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="166" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="167" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="168" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="169" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="3" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="4" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="1" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="2" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="170" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="49" fontId="0" fillId="0" borderId="0" xfId="0" applyNumberFormat="1"/></cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0" /></cellStyles><dxfs count="0" /><tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4" /></styleSheet>'},excelParsers:[{match:/^\-?\d+\.\d%$/,style:60,fmt:function(e){return e/100}},{match:/^\-?\d+\.?\d*%$/,style:56,fmt:function(e){return e/100}},{match:/^\-?\$[\d,]+.?\d*$/,style:57},{match:/^\-?£[\d,]+.?\d*$/,style:58},{match:/^\-?€[\d,]+.?\d*$/,style:59},{match:/^\-?\d+$/,style:65},{match:/^\-?\d+\.\d{2}$/,style:66},{match:/^\([\d,]+\)$/,style:61,fmt:function(e){return-1*e.replace(/[\(\)]/g,"")}},{match:/^\([\d,]+\.\d{2}\)$/,style:62,fmt:function(e){return-1*e.replace(/[\(\)]/g,"")}},{match:/^\-?[\d,]+$/,style:63},{match:/^\-?[\d,]+\.\d{2}$/,style:64},{match:/^\d{4}\-\d{2}\-\d{2}$/,style:67},{match:/(https?:\/\/(?:www\.|(?!www))[^\s\.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/gi,style:4}],addExcelStyle:function(e,t,r,l){t=fe.extend({numFmtId:"0",fontId:"0",fillId:"0",borderId:"0",applyFont:"1",applyFill:"1",applyBorder:"1",xfId:"0",applyNumberFormat:"0",applyAlignment:"0"},t||{}),r=fe.extend({horizontal:"left",indent:"0",shrinkToFit:"1",textRotation:"0",vertical:"center",wrapText:"0"},r||{}),fe.isEmptyObject(e)&&(e.excel_parsers=!0);var o,a,n,d,i=l.getElementsByTagName("numFmts")[0],p=l.getElementsByTagName("cellXfs")[0],s=null,m=null;for(o in e)e.hasOwnProperty(o)&&(-1!==o.indexOf("format")&&(s=o),-1!==o.indexOf("style"))&&(m=o);return m&&!e[m]&&(a=d=0,s&&e[s]&&(n=fe(i.getElementsByTagName("numFmt")),fe.each(n,function(e,t){d++,a=Math.max(a,parseInt(fe(t).attr("numFmtId"),10))}),n=fe.jgrid.makeNode(l,"numFmt",{attr:{numFmtId:a+1,formatCode:e[s]}}),i.appendChild(n),fe(i).attr("count",d+1)),i=0!==a?a+1+"":"0",d=0,t.numFmtId=i,n="1"===t.applyAlignment?fe.jgrid.makeNode(l,"xf",{attr:t,children:[fe.jgrid.makeNode(l,"alignment",{attr:r})]}):fe.jgrid.makeNode(l,"xf",{attr:t}),p.appendChild(n),d=fe("cellXfs xf",l).length,fe(p).attr("count",d),e[m]=d-1),e},newExcelStyle:function(e,t){t=fe.extend(!0,{font:{size:11,name:"Calibri",options:""},color:{patternType:"solid",fgColor:"FFFFFFF",bgColor:64}},t||{});var e=e.xl["styles.xml"],r=fe("cellXfs xf",e).length-1,l=fe("fonts font",e).length-1,o=fe("fills fill",e).length-1,a='<font><sz val="'+t.font.size+'" /><name val="'+t.font.name+'" />'+t.font.options+"</font>",a=(e.childNodes[0].childNodes[1].innerHTML+=a,"indexed="),t=(0<=parseInt(t.color.bgColor,10)&&(a="rgb="),a+='"'+t.color.bgColor+'"','<fill><patternFill patternType="'+t.color.patternType+'"><fgColor rgb="'+t.color.fgColor+'" /><bgColor '+a+" /></patternFill></fill>"),a=(e.childNodes[0].childNodes[2].innerHTML+=t,'<xf numFmtId="0" fontId="'+(1+l)+'" fillId="'+(1+o)+'" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"></xf>');return e.childNodes[0].childNodes[5].innerHTML+=a,1+r}}),fe.jgrid.extend({exportToCsv:function(k){k=fe.extend(!0,{separator:",",separatorReplace:" ",quote:'"',escquote:'"',newLine:"\r\n",replaceNewLine:" ",includeCaption:!0,includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,includeHeader:!0,fileName:"jqGridExport.csv",mimetype:"text/csv;charset=utf-8",returnAsString:!1,onBeforeExport:null,treeindent:" ",visibleTreeNodes:!1,loadIndicator:!0},k||{});var N="";return this.each(function(){k._regexsep=new RegExp(k.separator,"g"),k._regexquot=new RegExp(k.quote,"g");var e,t,j=this,r=j.p.treeGrid?fe(j).jqGrid("getRowData",null,!0,k.treeindent,k.visibleTreeNodes):j.addLocalData(!0),l=r.length,o=j.p.colModel,a=o.length,n=j.p.colNames,d=0,i="",p="",s="",m="",f="",c=[],u="";fe.jgrid.isFunction(k.loadIndicator)?k.loadIndicator.call(j,"show"):k.loadIndicator&&fe(j).jqGrid("progressBar",{method:"show",loadtype:j.p.loadui,htmlcontent:fe.jgrid.getRegional(j,"defaults.loadtext")});var g,h,y=[];if(fe.each(o,function(e,t){t._expcol=!0,void 0===t.exportcol?t.hidden&&(t._expcol=!1):t._expcol=t.exportcol,"cb"!==t.name&&"rn"!==t.name&&"subgrid"!==t.name&&"sc"!==t.name||(t._expcol=!1),t._expcol&&(c.push(fe.jgrid.formatCellCsv(n[e],k)),y.push(t.name))}),k.includeLabels&&(f=c.join(k.separator)+k.newLine),k.collen=c.length,j.p.grouping){var x=!!j.p.groupingView._locgr;j.p.groupingView._locgr=!1,i+=function(s,m){var f="",c=j.p.groupingView,u=[],g=c.groupField.length,h=j.p.colModel,y=h.length,x=0;function I(a,e,t,r){for(var l,o,n=function(e,t){var r,l=!1;if(0===e)l=t[a];else{var o=t[a].idx;if(0===o)l=t[a];else for(r=a;0<=r;r--)if(t[r].idx===o-e){l=t[r];break}}return l}(e,t),d=n.cnt,i=new Array(m.collen),p=0,s=r;s<y;s++)h[s]._expcol&&(o="{0}",fe.each(n.summary,function(){if(this.nm===h[s].name){h[s].summaryTpl&&(o=h[s].summaryTpl),l=this.v,"string"==typeof this.st&&"avg"===this.st.toLowerCase()&&(this.sd&&this.vd?l=this.v/this.vd:this.v&&0<d&&(l=this.v/d));try{this.groupCount=n.cnt,this.groupIndex=n.dataIndex,this.groupValue=n.value,l=j.formatter("",l,s,this)}catch(e){l=this.v}return i[p]=fe.jgrid.formatCellCsv(fe.jgrid.stripHtml(fe.jgrid.template(o,l)),m),!1}}),p++);return i}fe.each(h,function(e,t){for(var r=0;r<g;r++)if(c.groupField[r]===t.name){u[r]=e;break}});var F,b,v=fe.makeArray(c.groupSummary);if(v.reverse(),"local"===j.p.datatype&&!j.p.loadonce){fe(j).jqGrid("groupingSetup");for(var e=fe.jgrid.getMethod("groupingPrepare"),t=0;t<l;t++)e.call(fe(j),r[t],t)}return fe.each(c.groups,function(e,t){x++;try{F=Array.isArray(c.formatDisplayField)&&fe.jgrid.isFunction(c.formatDisplayField[t.idx])?c.formatDisplayField[t.idx].call(j,t.displayValue,t.value,j.p.colModel[u[t.idx]],t.idx,c):j.formatter("",t.displayValue,u[t.idx],t.value)}catch(e){F=t.displayValue}var r,l="";if("string"!=typeof(l=fe.jgrid.isFunction(c.groupText[t.idx])?c.groupText[t.idx].call(j,F,t.cnt,t.summary):fe.jgrid.template(c.groupText[t.idx],F,t.cnt,t.summary))&&"number"!=typeof l&&(l=F),(r="header"===c.groupSummaryPos[t.idx]?I(e,0,c.groups,0):new Array(m.collen))[0]=fe.jgrid.formatCellCsv(fe.jgrid.stripHtml(l),m),f+=r.join(m.separator)+m.newLine,g-1===t.idx){for(var o,a,n,d=c.groups[e+1],l=t.startRow,i=void 0!==d?d.startRow:c.groups[e].startRow+c.groups[e].cnt,p=l;p<i&&s[+p];p++){for(a=s[+p],o=b=0;o<h.length;o++)h[o]._expcol&&(r[b]=fe.jgrid.formatCellCsv(fe.jgrid.formatCell(fe.jgrid.getAccessor(a,h[o].name),o,a,h[o],j,"csv"),m),b++);f+=r.join(m.separator)+m.newLine}if("header"!==c.groupSummaryPos[t.idx]){if(void 0!==d){for(n=0;n<c.groupField.length&&d.dataIndex!==c.groupField[n];n++);x=c.groupField.length-n}for(o=0;o<x;o++)v[o]&&(r=I(e,o,c.groups,0),f+=r.join(m.separator)+m.newLine);x=n}}}),f}(r,k),j.p.groupingView._locgr=x}else for(;d<l;){for(e=r[d],v=[],F=t=0;F<a;F++)o[F]._expcol&&(v[t]=fe.jgrid.formatCellCsv(fe.jgrid.formatCell(fe.jgrid.getAccessor(e,o[F].name),F,e,o[F],j,"csv"),k),t++);i+=v.join(k.separator)+k.newLine,d++}if(r=null,v=new Array(k.collen),k.includeCaption&&j.p.caption){for(d=k.collen;--d;)v[d]="";v[0]=fe.jgrid.formatCellCsv(j.p.caption,k),p+=v.join(k.separator)+k.newLine}if(k.includeGroupHeader&&fe(j).jqGrid("isGroupHeaderOn"))for(var I=j.p.groupHeader,F=0;F<I.length;F++){for(var b=I[F].groupHeaders,d=0,v=[],w=0;w<y.length;w++){for(v[d]="",t=0;t<b.length;t++)b[t].startColumnName===y[w]&&(v[d]=fe.jgrid.formatCellCsv(b[t].titleText,k));d++}s+=v.join(k.separator)+k.newLine}if(k.includeFooter&&j.p.footerrow)for(var C,_,B=fe(j).jqGrid("footerData","getlength"),T=0;T<B;T++){for(C=fe(j).jqGrid("footerData","get",null,!1,T,!1),F=0,v=[];F<k.collen;)C.hasOwnProperty(_=y[F])&&v.push(fe.jgrid.formatCellCsv(fe.jgrid.stripHtml(C[_]),k)),F++;m+=v.join(k.separator)+k.newLine}if(k.includeHeader&&j.p.headerrow)for(B=fe(j).jqGrid("headerData","getlength"),T=0;T<B;T++){for(g=fe(j).jqGrid("headerData","get",null,!1,T,!1),F=0,v=[];F<k.collen;)g.hasOwnProperty(h=y[F])&&v.push(fe.jgrid.formatCellCsv(fe.jgrid.stripHtml(g[h]),k)),F++;u+=v.join(k.separator)+k.newLine}if(N=p+s+f+u+i+m,fe.jgrid.isFunction(k.loadIndicator)?k.loadIndicator.call(j,"hide"):k.loadIndicator&&fe(j).jqGrid("progressBar",{method:"hide",loadtype:j.p.loadui}),fe.jgrid.isFunction(k.onBeforeExport)&&!(N=k.onBeforeExport.call(j,N)))throw"Before export does not return data!";k.returnAsString||(-1!==k.mimetype.toUpperCase().indexOf("UTF-8")&&(N="\ufeff"+N),fe.jgrid.saveAs(N,k.fileName,{type:k.mimetype}))}),N},exportToExcel:function(me){me=fe.extend(!0,{includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,includeHeader:!0,fileName:"jqGridExport.xlsx",mimetype:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",maxlength:40,onBeforeExport:null,customizeData:null,replaceStr:null,treeindent:" ",visibleTreeNodes:!1,loadIndicator:!0},me||{}),this.each(function(){for(var e,G,h=this,t=fe.jgrid.excelStrings,P=0,y=fe.parseXML(t["xl/worksheets/sheet1.xml"]),O=y.getElementsByTagName("sheetData")[0],r=fe.parseXML(t["xl/styles.xml"]),t={_rels:{".rels":fe.parseXML(t["_rels/.rels"])},xl:{_rels:{"workbook.xml.rels":fe.parseXML(t["xl/_rels/workbook.xml.rels"])},"workbook.xml":fe.parseXML(t["xl/workbook.xml"]),"styles.xml":r,worksheets:{"sheet1.xml":y}},"[Content_Types].xml":fe.parseXML(t["[Content_Types].xml"])},x=h.p.colModel,l=0,I={body:h.p.treeGrid?fe(h).jqGrid("getRowData",null,!0,me.treeindent,me.visibleTreeNodes):h.addLocalData(!0),header:[],footer:[],width:[],map:[],parser:[],labels:[],hidden:[],mergecell:[]},E=fe.jgrid.addExcelStyle({excel_header_style:""},{fontId:"2",applyAlignment:"1"},{horizontal:"center",vertical:"center"},r).excel_header_style,o=0,L=x.length;o<L;o++)x[o]._expcol=!0,void 0===x[o].exportcol?x[o].hidden&&(x[o]._expcol=!1):x[o]._expcol=x[o].exportcol,void 0===x[o]._colspancell&&(x[o]._colspancell=!1),fe.jgrid.isServiceCol(x[o].name)||!x[o]._expcol?I.hidden.push(x[o].name):(I.header[l]=x[o].name,I.width[l]=5,I.map[l]=o,I.labels[l]=h.p.colNames[o],x[o].hasOwnProperty("exportoptions")?(e={},G={},x[o].exportoptions.excel_format&&(e=fe.jgrid.addExcelStyle({excel_format:x[o].exportoptions.excel_format,excel_style:x[o].exportoptions.excel_style||""},{},{},r)),x[o].exportoptions.excel_header_format&&(G=fe.jgrid.addExcelStyle({excel_header_format:x[o].exportoptions.excel_header_format,excel_header_style:x[o].exportoptions.excel_header_style||""},{fontId:"2",applyAlignment:"1"},{horizontal:"center"},r)),I.parser[o]=fe.extend(e,G),x[o].exportoptions.replace_format&&(I.parser[o].replace_format=x[o].exportoptions.replace_format),x[o].exportoptions.replace_header_format&&(I.parser[o].replace_header_format=x[o].exportoptions.replace_header_format)):I.parser[o]={excel_parsers:!0},l++);if(me.includeFooter||h.p.footerrow)for(var a,V=fe(h).jqGrid("footerData","getlength"),M=0;M<V;M++){for(l in a=fe(h).jqGrid("footerData","get",null,!1,M,!1))a.hasOwnProperty(l)&&(a[l]=fe.jgrid.stripHtml(a[l]));I.footer.push(a)}function F(e,t){return fe.jgrid.makeNode(y,"c",{attr:e,children:[fe.jgrid.makeNode(y,"v",{text:t})]})}function b(e,t,r){return fe.jgrid.makeNode(y,"c",{attr:{t:"inlineStr",r:e,s:r=void 0===r?68:r},children:{row:fe.jgrid.makeNode(y,"is",{children:{row:fe.jgrid.makeNode(y,"t",{text:t})}})}})}fe.jgrid.isFunction(me.customizeData)&&me.customizeData.call(h,I);var R,v,z=fe.jgrid.isFunction(me.replaceStr)?me.replaceStr:function(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F-\x9F]/g,"")},s=function(e,t,r,l){void 0===r&&(r=!1),void 0===l&&(l=!1),R=P+1,v=fe.jgrid.makeNode(y,"row",{attr:{r:R}});for(var o,a,n=0;n<I.header.length;n++){var d,i,p=fe.jgrid.excelCellPos(n)+""+R,s=(null==(g=Array.isArray(e)&&t?I.labels[n]:fe.jgrid.getAccessor(e,I.header[n]))&&(g=""),t||(g=0===n&&l||l&&""===g?g:fe.jgrid.formatCell(g,I.map[n],e,x[I.map[n]],h,"excel"))&&("&nbsp;"===g||"&#160;"===g||1===g.length&&160===g.charCodeAt(0))&&(g=""),I.width[n]=Math.max(I.width[n],Math.min(parseInt(g.toString().length,10),me.maxlength)),d=null,I.parser[I.map[n]]);if(t&&r)s.replace_header_format&&(g=s.replace_header_format(g)),d=void 0!==s.excel_header_style?"text"===s.excel_header_style?b(p,g):s.excel_header_style<=55?b(p,g,s.excel_header_style):F({r:p,s:s.excel_header_style},g):b(p,g,E),v.appendChild(d);else if(!0!==s.excel_parsers||d)void 0===s.excel_style||t||d||(s.replace_format&&(g=s.replace_format(g)),d="text"===s.excel_style?b(p,g):s.excel_style<=55?b(p,g,s.excel_style):F({r:p,s:s.excel_style},g),v.appendChild(d));else for(var m=0,f=fe.jgrid.excelParsers.length;m<f;m++){var c=fe.jgrid.excelParsers[m];if(g.match&&!g.match(/^0\d+/)&&g.match(c.match)){var u=g,g=g.replace(/[^\d\.\-]/g,"");if(c.fmt&&(g=c.fmt(g)),67===c.style)d=F({t:"d",r:p,s:c.style},g);else if(4===c.style)o=u,a=void 0,(a=document.createElement("div")).innerHTML=o,d=(g="A"===(o=a.firstChild).nodeName?[o.href,o.text]:"#text"===o.nodeName&&[o.textContent,o.textContent])?(a={t:"str",r:p,s:c.style},o='HYPERLINK("'+g[0]+'","'+g[1]+'")',fe.jgrid.makeNode(y,"c",{attr:a,children:[fe.jgrid.makeNode(y,"f",{text:o})]})):b(p,u);else{if(fe.inArray(c.style,["63","64","65","66"])&&15<g.toString().length){d=b(p,u.replace?z(u):u),v.appendChild(d);break}d=F({r:p,s:c.style},g)}v.appendChild(d);break}}d||(g.match&&(i=g.match(/^-?([1-9]\d+)(\.(\d+))?$/)),d="number"==typeof g&&g.toString().length<=15||i&&i[1].length+(i[2]?i[3].length:0)<=15?F({t:"n",r:p},g):b(p,g.replace?z(g):g),v.appendChild(d))}O.appendChild(v),P++};fe.jgrid.isFunction(me.loadIndicator)?me.loadIndicator.call(h,"show"):me.loadIndicator&&fe(h).jqGrid("progressBar",{method:"show",loadtype:h.p.loadui,htmlcontent:fe.jgrid.getRegional(h,"defaults.loadtext")}),fe("sheets sheet",t.xl["workbook.xml"]).attr("name",me.sheetName);var n,d,i,p,m,f,c=0,u=[],g={};if(me.includeGroupHeader&&fe(h).jqGrid("isGroupHeaderOn"))for(n=h.p.groupHeader,i=0;i<n.length;i++){var j,w,C,_,B=n[i].groupHeaders,$=n[i].useColSpanStyle&&1===n.length,X=[],U=[],Z=[];if(c++,$)for(j=0;j<B.length;j++)for(d=B[j].startColumnName,w=B[j].numberOfColumns,_=C=fe.jgrid.getElemByAttrVal(x,"name",d,!0);_<C+B[j].numberOfColumns;_++)Z[x[_].name]=d,-1!==(p=I.header.indexOf(x[_].name))&&X.push(p);for(o=0;o<I.header.length;o++){for(g[d=I.header[o]]=$?I.labels[o]:"",f=m=-1,j=0;j<B.length;j++)if(B[j].startColumnName===d){for(U.push(d),g[d]=B[j].titleText,w=B[j].numberOfColumns,_=C=fe.jgrid.getElemByAttrVal(x,"name",d,!0);_<C+B[j].numberOfColumns;_++)!0===x[_].hidden&&w--;m=fe.jgrid.excelCellPos(o)+c,f=fe.jgrid.excelCellPos(o+w-1)+c,u.push({ref:m+":"+f})}-1===m&&-1===f&&$&&-1===X.indexOf(o)&&(m=fe.jgrid.excelCellPos(o)+c,f=fe.jgrid.excelCellPos(o)+(c+1),u.push({ref:m+":"+f}))}if(U.length<B.length)for(j=0;j<I.hidden.length;j++){var T=fe.jgrid.inColumnHeader(I.hidden[j],B);if(0<=T)for(var k in d=I.hidden[j],Z)if(Z[k]===d&&g[k]){for(g[k]=B[T].titleText,p=I.header.indexOf(k),w=B[T].numberOfColumns,_=C=fe.jgrid.getElemByAttrVal(x,"name",d,!0);_<C+B[T].numberOfColumns;_++)!0===x[_].hidden&&w--;m=fe.jgrid.excelCellPos(p)+c,f=fe.jgrid.excelCellPos(p+w-1)+c,u.push({ref:m+":"+f});break}}s(g,!0,!0)}if(me.includeLabels)if(h.p.colSpanHeader.length){for(c++,n=h.p.colSpanHeader,g={},o=0;o<I.header.length;o++)for(g[d=I.header[o]]=I.labels[o],i=0;i<n.length;i++)(B=n[i]).startColumnName===d&&(g[d]=B.titleText,m=fe.jgrid.excelCellPos(o)+c,f=fe.jgrid.excelCellPos(o+B.numberOfColumns-1)+c,u.push({ref:m+":"+f}));s(g,!0,!0)}else s(I.header,!0,!0);if((u=I.mergecell.length?u.concat(I.mergecell):u).length){var W=fe.jgrid.makeNode(y,"mergeCells",{attr:{count:u.length}});for(fe("worksheet",y).append(W),l=0;l<u.length;l++)W.appendChild(fe.jgrid.makeNode(y,"mergeCell",{attr:u[l]}))}if(me.includeHeader||h.p.headerrow)for(var N,J=fe(h).jqGrid("headerData","getlength"),K=0;K<J;K++){for(l in N=fe(h).jqGrid("headerData","get",null,!1,K,!1))N.hasOwnProperty(l)&&(N[l]=fe.jgrid.stripHtml(N[l]));fe.isEmptyObject(N)||(s(N,!0),fe("row",y).last().find("c").attr("s","2"))}if(h.p.grouping){var Q=!!h.p.groupingView._locgr,Y=(h.p.groupingView._locgr=!1,I.body),S=h.p.groupingView,ee=[],te=S.groupField.length,re=x.length,A=0;function le(a,e,t,r){for(var l,o,n=function(e,t){var r,l=!1;if(0===e)l=t[a];else{var o=t[a].idx;if(0===o)l=t[a];else for(r=a;0<=r;r--)if(t[r].idx===o-e){l=t[r];break}}return l}(e,t),d=n.cnt,i=oe(I.header),p=r;p<re;p++)x[p]._expcol&&(o="{0}",fe.each(n.summary,function(){if(this.nm===x[p].name){x[p].summaryTpl&&(o=x[p].summaryTpl),l=this.v,"string"==typeof this.st&&"avg"===this.st.toLowerCase()&&(this.sd&&this.vd?l=this.v/this.vd:this.v&&0<d&&(l=this.v/d));try{this.groupCount=n.cnt,this.groupIndex=n.dataIndex,this.groupValue=n.value}catch(e){l=this.v}return i[this.nm]=fe.jgrid.stripHtml(fe.jgrid.template(o,l)),!1}}));return i}function oe(e){for(var t={},r=0;r<e.length;r++)t[e[r]]="";return t}fe.each(x,function(e,t){for(var r=0;r<te;r++)if(S.groupField[r]===t.name){ee[r]=e;break}});var H,ae=fe.makeArray(S.groupSummary);if(ae.reverse(),"local"===h.p.datatype&&!h.p.loadonce){fe(h).jqGrid("groupingSetup");for(var ne=fe.jgrid.getMethod("groupingPrepare"),D=0;D<I.body.length;D++)ne.call(fe(h),I.body[D],D)}fe.each(S.groups,function(e,t){A++;try{H=Array.isArray(S.formatDisplayField)&&fe.jgrid.isFunction(S.formatDisplayField[t.idx])?S.formatDisplayField[t.idx].call(h,t.displayValue,t.value,h.p.colModel[ee[t.idx]],t.idx,S):h.formatter("",t.displayValue,ee[t.idx],t.value)}catch(e){H=t.displayValue}var r="",l=("string"!=typeof(r=fe.jgrid.isFunction(S.groupText[t.idx])?S.groupText[t.idx].call(h,H,t.cnt,t.summary):fe.jgrid.template(S.groupText[t.idx],H,t.cnt,t.summary))&&"number"!=typeof r&&(r=H),"header"===S.groupSummaryPos[t.idx]?le(e,0,S.groups,0):oe(I.header));if(l[Object.keys(l)[0]]=fe.jgrid.stripHtml(new Array(5*t.idx).join(" ")+r),s(l,!1,!1,!0),te-1===t.idx){for(var o,a,n=S.groups[e+1],r=t.startRow,d=void 0!==n?n.startRow:S.groups[e].startRow+S.groups[e].cnt,i=r;i<d&&Y[+i];i++){var p=Y[+i];s(p,!1)}if("header"!==S.groupSummaryPos[t.idx]){if(void 0!==n){for(a=0;a<S.groupField.length&&n.dataIndex!==S.groupField[a];a++);A=S.groupField.length-a}for(o=0;o<A;o++)ae[o]&&(l=le(e,o,S.groups,0),s(l,!1,!1,!0));A=a}}}),h.p.groupingView._locgr=Q}else for(var q=0,de=I.body.length;q<de;q++)s(I.body[q],!1);if((me.includeFooter||h.p.footerrow)&&!fe.isEmptyObject(I.footer))if(Array.isArray(I.footer))for(q=0;q<I.footer.length;q++)s(I.footer[q],!0),fe("row",y).last().find("c").attr("s","2");else s(I.footer,!0),fe("row",y).last().find("c").attr("s","2");var ie=fe.jgrid.makeNode(y,"cols");for(fe("worksheet",y).prepend(ie),l=0,L=I.width.length;l<L;l++)ie.appendChild(fe.jgrid.makeNode(y,"col",{attr:{min:l+1,max:l+1,width:I.width[l],customWidth:1}}));fe.jgrid.isFunction(me.onBeforeExport)&&me.onBeforeExport.call(h,t,P),I=null;try{var pe=new JSZip,se={type:"blob",mimeType:me.mimetype};fe.jgrid.xmlToZip(pe,t),pe.generateAsync?pe.generateAsync(se).then(function(e){fe.jgrid.saveAs(e,me.fileName,{type:me.mimetype})}):fe.jgrid.saveAs(pe.generate(se),me.fileName,{type:me.mimetype})}catch(e){throw e}finally{fe.jgrid.isFunction(me.loadIndicator)?me.loadIndicator.call(h,"hide"):me.loadIndicator&&fe(h).jqGrid("progressBar",{method:"hide",loadtype:h.p.loadui})}})},exportToPdf:function(R){return R=fe.extend(!0,{title:null,orientation:"portrait",pageSize:"A4",description:null,onBeforeExport:null,download:"download",includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,includeHeader:!0,fileName:"jqGridExport.pdf",mimetype:"application/pdf",treeindent:"-",visibleTreeNodes:!1,centerTableOnPage:!1,loadIndicator:!0},R||{}),this.each(function(){var e,t,r,s=this,m=[],l=s.p.colModel,d={},i=s.p.treeGrid?fe(s).jqGrid("getRowData",null,!0,R.treeindent,R.visibleTreeNodes):s.addLocalData(!0),f=[],p=0,c=[],o=[],a=[],u={};for(fe.jgrid.isFunction(R.loadIndicator)?R.loadIndicator.call(s,"show"):R.loadIndicator&&fe(s).jqGrid("progressBar",{method:"show",loadtype:s.p.loadui,htmlcontent:fe.jgrid.getRegional(s,"defaults.loadtext")}),e=0,D=l.length;e<D;e++)l[e]._expcol=!0,void 0===l[e].exportcol?l[e].hidden&&(l[e]._expcol=!1):l[e]._expcol=l[e].exportcol,!fe.jgrid.isServiceCol(l[e].name)&&l[e]._expcol&&(d={text:s.p.colNames[e],style:"tableHeader"},o.push(d),f[p]=l[e].name,c[p]=e,a.push(l[e].width),u[l[e].name]=l[e].align||"left",p++);if(R.includeGroupHeader&&fe(s).jqGrid("isGroupHeaderOn"))for(r=s.p.groupHeader,p=0;p<r.length;p++){for(var n=[],g=r[p].groupHeaders,G=r[p].useColSpanStyle,h=0;h<l.length;h++){var y=!0;for(fe.jgrid.isServiceCol(l[h].name)||!l[h]._expcol?y=!1:d=G?{text:s.p.colNames[h],style:"tableHeader",rowSpan:2,verticalAlign:"center"}:{text:"",style:"tableHeader"},t=0;t<g.length;t++)if(g[t].startColumnName===l[h].name){for(var x=g[t].numberOfColumns,I=h;I<h+g[t].numberOfColumns;I++)!0===l[I].hidden&&x--;!(d={text:g[t].titleText,colSpan:x,style:"tableHeader"})===y&&0<x&&(y=!0,h+=g[t].numberOfColumns-x)}y&&n.push(d)}m.push(n)}if(R.includeLabels)if(s.p.colSpanHeader.length){for(r=s.p.colSpanHeader,n=[],h=0;h<f.length;h++){for(d={text:s.p.colNames[h],style:"tableHeader",verticalAlign:"center"},t=0;t<r.length;t++)r[t].startColumnName===f[h]&&(d={text:r[t].titleText,colSpan:r[t].numberOfColumns,style:"tableHeader"});n.push(d),e++}m.push(n)}else m.push(o);if(R.includeHeader&&s.p.headerrow)for(var F,b=fe(s).jqGrid("headerData","getlength"),v=0;v<b;v++){for(F=fe(s).jqGrid("headerData","get",null,!1,v,!1),o=[],h=0;h<f.length;h++)d={text:fe.jgrid.stripHtml(fe.jgrid.getAccessor(F,f[h])),style:"tableFooter",alignment:u[f[h]]},o.push(d);m.push(o)}if(s.p.grouping){var j=!!s.p.groupingView._locgr,w=(s.p.groupingView._locgr=!1,i),C=s.p.groupingView,_=[],B=C.groupField.length,T=s.p.colModel,P=T.length,k=0;function N(e,t,r){var l,o=0,a=[];void 0===r&&(r=!1);for(var n=0;n<f.length;n++)l=e[f[n]],d={text:null==l||""===l?"":!t||0===n&&r?l:fe.jgrid.formatCell(l+"",c[o],i[p],T[c[o]],s,"pdf"),alignment:u[n],style:"tableBody"},a.push(d),o++;return a}function O(a,e,t,r){for(var l,o,n=function(e,t){var r,l=!1;if(0===e)l=t[a];else{var o=t[a].idx;if(0===o)l=t[a];else for(r=a;0<=r;r--)if(t[r].idx===o-e){l=t[r];break}}return l}(e,t),d=n.cnt,i=E(f),p=r;p<P;p++)T[p]._expcol&&(o="{0}",fe.each(n.summary,function(){if(this.nm===T[p].name){T[p].summaryTpl&&(o=T[p].summaryTpl),l=this.v,"string"==typeof this.st&&"avg"===this.st.toLowerCase()&&(this.sd&&this.vd?l=this.v/this.vd:this.v&&0<d&&(l=this.v/d));try{this.groupCount=n.cnt,this.groupIndex=n.dataIndex,this.groupValue=n.value}catch(e){l=this.v}return i[this.nm]=fe.jgrid.stripHtml(fe.jgrid.template(o,l)),!1}}));return i}function E(e){for(var t={},r=0;r<e.length;r++)t[e[r]]="";return t}fe.each(T,function(e,t){for(var r=0;r<B;r++)if(C.groupField[r]===t.name){_[r]=e;break}});var S,L=fe.makeArray(C.groupSummary);if(L.reverse(),"local"===s.p.datatype&&!s.p.loadonce){fe(s).jqGrid("groupingSetup");for(var V=fe.jgrid.getMethod("groupingPrepare"),A=0;A<i.length;A++)V.call(fe(s),i[A],A)}fe.each(C.groups,function(e,t){k++;try{S=Array.isArray(C.formatDisplayField)&&fe.jgrid.isFunction(C.formatDisplayField[t.idx])?C.formatDisplayField[t.idx].call(s,t.displayValue,t.value,s.p.colModel[_[t.idx]],t.idx,C):s.formatter("",t.displayValue,_[t.idx],t.value)}catch(e){S=t.displayValue}var r="",l=("string"!=typeof(r=fe.jgrid.isFunction(C.groupText[t.idx])?C.groupText[t.idx].call(s,S,t.cnt,t.summary):fe.jgrid.template(C.groupText[t.idx],S,t.cnt,t.summary))&&"number"!=typeof r&&(r=S),"header"===C.groupSummaryPos[t.idx]?O(e,0,C.groups,0):E(f));if(l[Object.keys(l)[0]]=fe.jgrid.stripHtml(new Array(5*t.idx).join(" ")+r),m.push(N(l,!0,!0)),B-1===t.idx){for(var o,a,n=C.groups[e+1],r=t.startRow,d=void 0!==n?n.startRow:C.groups[e].startRow+C.groups[e].cnt,i=r;i<d&&w[+i];i++){var p=w[+i];m.push(N(p,!0))}if("header"!==C.groupSummaryPos[t.idx]){if(void 0!==n){for(a=0;a<C.groupField.length&&n.dataIndex!==C.groupField[a];a++);k=C.groupField.length-a}for(o=0;o<k;o++)L[o]&&(l=O(e,o,C.groups,0),m.push(N(l,!0,!0)));k=a}}}),s.p.groupingView._locgr=j}else for(var H,p=0,D=i.length;p<D;p++){for(o=[],H=i[p],h=t=0;h<f.length;h++)d={text:null==H[f[h]]?"":fe.jgrid.stripHtml(fe.jgrid.formatCell(fe.jgrid.getAccessor(H,f[h])+"",c[t],i[p],l[c[t]],s,"pdf")),alignment:u[f[h]],style:"tableBody"},o.push(d),t++;m.push(o)}if(R.includeFooter&&s.p.footerrow)for(b=fe(s).jqGrid("footerData","getlength"),v=0;v<b;v++){for(var M=fe(s).jqGrid("footerData","get",null,!1,v,!1),o=[],h=0;h<f.length;h++)d={text:fe.jgrid.stripHtml(fe.jgrid.getAccessor(M,f[h])),style:"tableFooter",alignment:u[f[h]]},o.push(d);m.push(o)}j={style:"tableExample",widths:a,table:{headerRows:null!=r?0:1,body:m}},R.centerTableOnPage&&(j={columns:[{width:"*",text:""},{style:"tableExample",width:"auto",widths:a,table:{headerRows:null!=r?0:1,body:m},alignment:"center"},{width:"*",text:""}]}),j={pageSize:R.pageSize,pageOrientation:R.orientation,content:[j],styles:{tableHeader:{bold:!0,fontSize:11,color:"#2e6e9e",fillColor:"#dfeffc",alignment:"center"},tableBody:{fontSize:10},tableFooter:{bold:!0,fontSize:11,color:"#2e6e9e",fillColor:"#dfeffc"},title:{alignment:"center",fontSize:15},description:{}},defaultStyle:{fontSize:10}},R.description&&j.content.unshift({text:R.description,style:"description",margin:[0,0,0,12]}),R.title&&j.content.unshift({text:R.title,style:"title",margin:[0,0,0,12]}),fe.jgrid.isFunction(R.onBeforeExport)&&R.onBeforeExport.call(s,j);try{var q=pdfMake.createPdf(j);q.getDataUrl(function(e){fe.jgrid.isFunction(R.loadIndicator)?R.loadIndicator.call(s,"hide"):R.loadIndicator&&fe(s).jqGrid("progressBar",{method:"hide",loadtype:s.p.loadui})}),"open"===R.download?q.open():q.getBuffer(function(e){fe.jgrid.saveAs(e,R.fileName,{type:R.mimetype})})}catch(e){throw e}})},exportToHtml:function(c){var u;return c=fe.extend(!0,{title:"",onBeforeExport:null,includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,includeHeader:!0,tableClass:"jqgridprint",autoPrint:!1,topText:"",bottomText:"",returnAsString:!1,treeindent:"&nbsp;",visibleTreeNodes:!1,loadIndicator:!0},c||{}),this.each(function(){for(var v=this,m=v.p.colModel,e=0,j={body:v.p.treeGrid?fe(v).jqGrid("getRowData",null,!0,c.treeindent,c.visibleTreeNodes):v.addLocalData(!0),header:[],footer:[],width:[],map:[],align:[]},t=0,r=m.length;t<r;t++)m[t]._expcol=!0,void 0===m[t].exportcol?m[t].hidden&&(m[t]._expcol=!1):m[t]._expcol=m[t].exportcol,"cb"!==m[t].name&&"rn"!==m[t].name&&"subgrid"!==m[t].name&&"sc"!==m[t].name&&m[t]._expcol&&(j.header[e]=m[t].name,j.width[e]=m[t].width,j.map[e]=t,j.align[e]=m[t].align||"left",e++);function l(e){return o.href=e,-1===(e=o.host).indexOf("/")&&0!==o.pathname.indexOf("/")&&(e+="/"),o.protocol+"//"+e+o.pathname+o.search}var o=document.createElement("a"),w=function(e,t,r,l,o){for(var a,n,d="<tr>",i=0,p=j.header.length;i<p&&(n=o?' colspan= "'+j.header.length+'" style=text-align:left':!0===l?" style=width:"+j.width[i]+"px;text-align:"+j.align[i]+";":" style=text-align:"+j.align[i]+";",a=j.header[i],e.hasOwnProperty(a)&&(d+="<"+t+n+">"+(r?fe.jgrid.formatCell(fe.jgrid.getAccessor(e,a),j.map[i],e,m[j.map[i]],v,"html"):e[a])+"</"+t+">"),!o);i++);return d+"</tr>"};fe.jgrid.isFunction(c.loadIndicator)?c.loadIndicator.call(v,"show"):c.loadIndicator&&fe(v).jqGrid("progressBar",{method:"show",loadtype:v.p.loadui,htmlcontent:fe.jgrid.getRegional(v,"defaults.loadtext")});var a='<table class="'+c.tableClass+'">';if(c.includeLabels&&(a+="<thead>"+function(){for(var e="<tr>",t=0,r=j.header.length;t<r;t++)e+="<th style=width:"+j.width[t]+"px;>"+v.p.colNames[j.map[t]]+"</th>";return e+"</tr>"}()+"</thead>"),a+="<tbody>",c.includeHeader&&v.p.headerrow)for(var n,d=fe(v).jqGrid("footerData","getlength"),i=0;i<d;i++)for(i=0;i<d;i++)n=fe(v).jqGrid("headerData","get",null,!1,i,!1),a+=w(n,"td",!1);if(v.p.grouping){var p=!!v.p.groupingView._locgr;v.p.groupingView._locgr=!1,a+=function(f){var c=v.p.groupingView,u=[],g=c.groupField.length,s=m.length,h=0,y="";function x(a,e,t,r){for(var l,o,n=function(e,t){var r,l=!1;if(0===e)l=t[a];else{var o=t[a].idx;if(0===o)l=t[a];else for(r=a;0<=r;r--)if(t[r].idx===o-e){l=t[r];break}}return l}(e,t),d=n.cnt,i=I(j.header),p=r;p<s;p++)m[p]._expcol&&(o="{0}",fe.each(n.summary,function(){if(this.nm===m[p].name){m[p].summaryTpl&&(o=m[p].summaryTpl),l=this.v,"string"==typeof this.st&&"avg"===this.st.toLowerCase()&&(this.sd&&this.vd?l=this.v/this.vd:this.v&&0<d&&(l=this.v/d));try{this.groupCount=n.cnt,this.groupIndex=n.dataIndex,this.groupValue=n.value}catch(e){l=this.v}return i[this.nm]=fe.jgrid.stripHtml(fe.jgrid.template(o,l)),!1}}));return i}function I(e){for(var t={},r=0;r<e.length;r++)t[e[r]]="";return t}fe.each(m,function(e,t){for(var r=0;r<g;r++)if(c.groupField[r]===t.name){u[r]=e;break}});var F,b=fe.makeArray(c.groupSummary);if(b.reverse(),"local"===v.p.datatype&&!v.p.loadonce){fe(v).jqGrid("groupingSetup");for(var e=fe.jgrid.getMethod("groupingPrepare"),t=0;t<j.body.length;t++)e.call(fe(v),j.body[t],t)}return fe.each(c.groups,function(e,t){h++;try{F=Array.isArray(c.formatDisplayField)&&fe.jgrid.isFunction(c.formatDisplayField[t.idx])?c.formatDisplayField[t.idx].call(v,t.displayValue,t.value,v.p.colModel[u[t.idx]],t.idx,c):v.formatter("",t.displayValue,u[t.idx],t.value)}catch(e){F=t.displayValue}var r="";"string"!=typeof(r=fe.jgrid.isFunction(c.groupText[t.idx])?c.groupText[t.idx].call(v,F,t.cnt,t.summary):fe.jgrid.template(c.groupText[t.idx],F,t.cnt,t.summary))&&"number"!=typeof r&&(r=F);var l,o=!1,a=("header"===c.groupSummaryPos[t.idx]?l=x(e,0,c.groups,0):(l=I(j.header),o=!0),Object.keys(l));if(l[a[0]]=new Array(5*t.idx).join(" ")+r,y+=w(l,"td",!0,1===h,o),g-1===t.idx){for(var n,d,i=c.groups[e+1],a=t.startRow,p=void 0!==i?i.startRow:c.groups[e].startRow+c.groups[e].cnt,s=a;s<p&&f[+s];s++){var m=f[+s];y+=w(m,"td",!0)}if("header"!==c.groupSummaryPos[t.idx]){if(void 0!==i){for(d=0;d<c.groupField.length&&i.dataIndex!==c.groupField[d];d++);h=c.groupField.length-d}for(n=0;n<h;n++)b[n]&&(l=x(e,n,c.groups,0),y+=w(l,"td",!0));h=d}}}),y}(j.body),v.p.groupingView._locgr=p}else for(e=0,r=j.body.length;e<r;e++)a+=w(j.body[e],"td",!0,0===e);if(c.includeFooter&&v.p.footerrow)for(d=fe(v).jqGrid("footerData","getlength"),i=0;i<d;i++)j.footer[i]=fe(v).jqGrid("footerData","get",null,!1,i,!1),a+=w(j.footer[i],"td",!1);if(a+="</tbody></table>",c.returnAsString)u=a;else{var s=window.open("",""),f=(s.document.close(),c.title?"<title>"+c.title+"</title>":"");fe("style, link").each(function(){var e;f+=("link"===(e=fe(e=this).clone()[0]).nodeName.toLowerCase()&&(e.href=l(e.href)),e.outerHTML)});try{s.document.head.innerHTML=f}catch(e){fe(s.document.head).html(f)}s.document.body.innerHTML=(c.title?"<h1>"+c.title+"</h1>":"")+"<div>"+(c.topText||"")+"</div>"+a+"<div>"+(c.bottomText||"")+"</div>",fe(s.document.body).addClass("html-view"),fe("img",s.document.body).each(function(e,t){t.setAttribute("src",l(t.getAttribute("src")))}),fe.jgrid.isFunction(c.onBeforeExport)&&c.onBeforeExport.call(v,s),Boolean(s.chrome)?c.autoPrint&&(s.print(),s.close()):setTimeout(function(){c.autoPrint&&(s.print(),s.close())},1e3)}fe.jgrid.isFunction(c.loadIndicator)?c.loadIndicator.call(v,"hide"):c.loadIndicator&&fe(v).jqGrid("progressBar",{method:"hide",loadtype:v.p.loadui})}),u}})});